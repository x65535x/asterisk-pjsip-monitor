# Asterisk PJSIP Monitor

ะะตะฑ-ะธะฝัะตััะตะนั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ัะตะบัะธัะผะธ ะบะพะฝัะธะณััะฐัะธะธ Asterisk PJSIP ั **ัะตะฐะปัะฝัะผ ะผะพะฝะธัะพัะธะฝะณะพะผ** ััะฐัััะฐ ัะตะปะตัะพะฝะพะฒ, ะทะฒะพะฝะบะพะฒ ะธ ะปะพะณะพะฒ.

## ๐ ะััััะพะต ัะฐะทะฒะตัััะฒะฐะฝะธะต ะฝะฐ ัะตัะฒะตัะต

- **โก ะะปั ะฑะพะตะฒะพะณะพ ัะตัะฒะตัะฐ:** [SERVER_QUICKSTART.md](SERVER_QUICKSTART.md)
- **๐ ะะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั:** [PRODUCTION_DEPLOY.md](PRODUCTION_DEPLOY.md)
- **๐ง ะกะบัะธะฟั ัะฐะทะฒะตัััะฒะฐะฝะธั:** [deploy.sh](deploy.sh)

## ๐ ะะพะฒัะต ะฒะพะทะผะพะถะฝะพััะธ ะผะพะฝะธัะพัะธะฝะณะฐ

- ๐ **ะะตะฐะปัะฝัะน ะผะพะฝะธัะพัะธะฝะณ** ััะฐัััะฐ SIP-ัะตะปะตัะพะฝะพะฒ (Online/Offline)
- ๐ **ะะฝะดะธะบะฐัะธั ะฐะบัะธะฒะฝัั ะทะฒะพะฝะบะพะฒ** ั ะฐะฝะธะผะฐัะธะตะน
- ๐ **ะัะพัะผะพัั ะปะพะณะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ** ะดะปั ะบะฐะถะดะพะน ัะตะบัะธะธ
- ๐ **WebSocket ะพะฑะฝะพะฒะปะตะฝะธั** ะฑะตะท ะฟะตัะตะทะฐะณััะทะบะธ ัััะฐะฝะธัั
- ๐ **AMI ะธะฝัะตะณัะฐัะธั** ะดะปั ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั ะธะท Asterisk
- ๐ฏ **ะคะธะปัััะฐัะธั ะปะพะณะพะฒ** ะฟะพ ััะพะฒะฝั ะธ ะธััะพัะฝะธะบั

## ะะพะทะผะพะถะฝะพััะธ

- ๐ ะัะพัะผะพัั ัะฟะธัะบะฐ ัััะตััะฒัััะธั ัะตะบัะธะน ั ะธะฝะดะธะบะฐัะพัะฐะผะธ ััะฐัััะฐ
- โ ะกะพะทะดะฐะฝะธะต ะฝะพะฒัั ัะตะบัะธะน ั ะฐะฒัะพะณะตะฝะตัะฐัะธะตะน ัะฐะฑะปะพะฝะพะฒ
- โ๏ธ ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ัะตะบัะธะน ั ะฟะพะดัะฒะตัะบะพะน ัะธะฝัะฐะบัะธัะฐ (CodeMirror)
- ๐ HTTP Basic ะฐััะตะฝัะธัะธะบะฐัะธั
- ๐ ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟะตัะตะทะฐะณััะทะบะฐ Asterisk ะฟะพัะปะต ะธะทะผะตะฝะตะฝะธะน
- ๐ฑ ะกะพะฒัะตะผะตะฝะฝัะน ะพัะทัะฒัะธะฒัะน ะฒะตะฑ-ะธะฝัะตััะตะนั
- ๐ข **ะกัะฐััั ัะตะณะธัััะฐัะธะธ** SIP-ัะตะปะตัะพะฝะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- ๐ **ะะพะฝะธัะพัะธะฝะณ ะทะฒะพะฝะบะพะฒ** ั ะธะฝะดะธะบะฐัะธะตะน ะฐะบัะธะฒะฝัั ะฒัะทะพะฒะพะฒ
- ๐ **ะะพะณะธ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ** ั ัะธะปัััะฐัะธะตะน ะธ ะฟะพะธัะบะพะผ

## ะฃััะฐะฝะพะฒะบะฐ

1. ะฃะฑะตะดะธัะตัั, ััะพ ั ะฒะฐั ัััะฐะฝะพะฒะปะตะฝ Node.js (ะฒะตััะธั 14 ะธะปะธ ะฒััะต)
2. ะะปะพะฝะธััะนัะต ะฟัะพะตะบั:
   ```bash
   git clone <ัะตะฟะพะทะธัะพัะธะน>
   cd asterisk-pjsip-monitor
   ```
3. ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ:
   ```bash
   npm install
   ```

## ะะฐัััะพะนะบะฐ

### 1. ะะฐะทะพะฒะฐั ะฝะฐัััะพะนะบะฐ

1. ะฃะฑะตะดะธัะตัั, ััะพ ัะฐะนะป `/etc/asterisk/pjsip.conf` ัััะตััะฒัะตั ะธ ะดะพัััะฟะตะฝ ะดะปั ะทะฐะฟะธัะธ
2. ะะฐัััะพะนัะต sudo ะฟัะฐะฒะฐ ะดะปั ะฟะตัะตะทะฐะณััะทะบะธ Asterisk:
   ```bash
   sudo visudo
   # ะะพะฑะฐะฒััะต ัััะพะบั (ะทะฐะผะตะฝะธัะต your_user ะฝะฐ ะธะผั ะฟะพะปัะทะพะฒะฐัะตะปั):
   your_user ALL=(ALL) NOPASSWD: /usr/bin/systemctl reload asterisk
   ```
3. ะะทะผะตะฝะธัะต ะฟะฐัะพะปั ะฒ ัะฐะนะปะต `app.js` (ัััะพะบะฐ ั `USERS`):
   ```javascript
   const USERS = { admin: 'your_new_password' };
   ```

### 2. ะะฐัััะพะนะบะฐ ะผะพะฝะธัะพัะธะฝะณะฐ (AMI)

ะะปั ะฟะพะปะฝะพัะตะฝะฝะพะณะพ ะผะพะฝะธัะพัะธะฝะณะฐ ะฝะฐัััะพะนัะต Asterisk Manager Interface:

1. ะััะตะดะฐะบัะธััะนัะต `/etc/asterisk/manager.conf`:
   ```ini
   [general]
   enabled = yes
   port = 5038
   bindaddr = 127.0.0.1

   [admin]
   secret = your_ami_password
   deny = 0.0.0.0/0.0.0.0
   permit = 127.0.0.1/255.255.255.255
   read = system,call,log,verbose,command,agent,user,config,dtmf,reporting,cdr,dialplan
   write = system,call,log,verbose,command,agent,user,config,dtmf,reporting,cdr,dialplan
   ```

2. ะะฑะฝะพะฒะธัะต ะฝะฐัััะพะนะบะธ AMI ะฒ `app.js`:
   ```javascript
   const AMI_CONFIG = {
     port: 5038,
     host: 'localhost',
     username: 'admin',
     password: 'your_ami_password',
     events: 'on'
   };
   ```

3. ะะฐัััะพะนัะต ะปะพะณะธัะพะฒะฐะฝะธะต ะฒ `/etc/asterisk/logger.conf`:
   ```ini
   [logfiles]
   console => notice,warning,error
   messages => notice,warning,error
   full => notice,warning,error,debug,verbose
   ```

4. ะะตัะตะทะฐะฟัััะธัะต Asterisk:
   ```bash
   sudo systemctl restart asterisk
   ```

ะะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั ะฒ ัะฐะนะปะต `asterisk-ami-config.md`.

## ะะฐะฟััะบ

### ะขะตััะธัะพะฒะฐะฝะธะต:
```bash
npm run test
```
*ะะฐะฟััะบะฐะตั ะฒะตััะธั ั ัะธะผัะปััะธะตะน ะผะพะฝะธัะพัะธะฝะณะฐ ะดะปั ะดะตะผะพะฝัััะฐัะธะธ*

### ะะตะถะธะผ ัะฐะทัะฐะฑะพัะบะธ:
```bash
npm run dev
```

### ะัะพะดะฐะบัะฝ:
```bash
npm start
```

ะัะธะปะพะถะตะฝะธะต ะฑัะดะตั ะดะพัััะฟะฝะพ ะฟะพ ะฐะดัะตัั: http://localhost:8080

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

1. ะัะบัะพะนัะต ะฑัะฐัะทะตั ะธ ะฟะตัะตะนะดะธัะต ะฝะฐ http://localhost:8080
2. ะะฒะตะดะธัะต ะปะพะณะธะฝ: `admin` ะธ ะฟะฐัะพะปั: `secret123` (ะธะปะธ ะธะทะผะตะฝะตะฝะฝัะน ะฒะฐะผะธ)
3. ะะฐ ะณะปะฐะฒะฝะพะน ัััะฐะฝะธัะต ะฒั ัะฒะธะดะธัะต ัะตะบัะธะธ ั ะธะฝะดะธะบะฐัะพัะฐะผะธ ััะฐัััะฐ:
   - ๐ข **ะะตะปะตะฝัะน** - ัะตะปะตัะพะฝ ะทะฐัะตะณะธัััะธัะพะฒะฐะฝ ะธ ะดะพัััะฟะตะฝ
   - ๐ด **ะัะฐัะฝัะน** - ัะตะปะตัะพะฝ ะฝะต ะทะฐัะตะณะธัััะธัะพะฒะฐะฝ ะธะปะธ ะฝะตะดะพัััะฟะตะฝ
   - ๐ก **ะะตะปััะน (ะผะธะณะฐััะธะน)** - ะฐะบัะธะฒะฝัะน ะทะฒะพะฝะพะบ
4. ะะฐะถะผะธัะต **"๐ Logs"** ะดะปั ะฟัะพัะผะพััะฐ ะปะพะณะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
5. ะัะฟะพะปัะทัะนัะต **"๐ Refresh"** ะดะปั ะฟัะธะฝัะดะธัะตะปัะฝะพะณะพ ะพะฑะฝะพะฒะปะตะฝะธั ััะฐัััะฐ

### ะะพะฝะธัะพัะธะฝะณ ะปะพะณะพะฒ

- ะะปะธะบะฝะธัะต ะฝะฐ **"๐ Logs"** ะฝะฐะฟัะพัะธะฒ ะปัะฑะพะน ัะตะบัะธะธ
- ะะพะณะธ ะพัะพะฑัะฐะถะฐัััั ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- ะะพัััะฟะฝะฐ ัะธะปัััะฐัะธั ะฟะพ:
  - ะขะตะบััั ัะพะพะฑัะตะฝะธั
  - ะฃัะพะฒะฝั (ERROR, WARNING, NOTICE, DEBUG)
  - ะััะพัะฝะธะบั (PJSIP, res_pjsip, app_dial)
- ะะฒัะพะฟัะพะบัััะบะฐ ะธ ััะฐัะธััะธะบะฐ

## ะคะพัะผะฐั ัะตะบัะธะน

ะกะตะบัะธะธ ะฒ ัะฐะนะปะต pjsip.conf ะดะพะปะถะฝั ะฑััั ะฟะพะผะตัะตะฝั ัะฟะตัะธะฐะปัะฝัะผะธ ะบะพะผะผะตะฝัะฐัะธัะผะธ:

```ini
;--- section_name ---
[section-config]
type = endpoint
...
;/--- section_name ---
```

## ะะฝะดะธะบะฐัะพัั ััะฐัััะฐ

| ะะฝะดะธะบะฐัะพั | ะะฟะธัะฐะฝะธะต |
|-----------|----------|
| ๐ข Online | SIP-ัะตะปะตัะพะฝ ะทะฐัะตะณะธัััะธัะพะฒะฐะฝ ะธ ะดะพัััะฟะตะฝ |
| ๐ด Offline | SIP-ัะตะปะตัะพะฝ ะฝะต ะทะฐัะตะณะธัััะธัะพะฒะฐะฝ |
| โ Unknown | ะกัะฐััั ะฝะตะธะทะฒะตััะตะฝ (ะฝะตั ะดะฐะฝะฝัั ะพั AMI) |
| ๐ X calls | ะะพะปะธัะตััะฒะพ ะฐะบัะธะฒะฝัั ะทะฒะพะฝะบะพะฒ |
| โก ะะธะณะฐััะฐั ะณัะฐะฝะธัะฐ | ะะบัะธะฒะฝัะน ะทะฒะพะฝะพะบ ะฒ ะดะฐะฝะฝัะน ะผะพะผะตะฝั |

## ะะตะทะพะฟะฐัะฝะพััั

- ะัะธะปะพะถะตะฝะธะต ะธัะฟะพะปัะทัะตั HTTP Basic ะฐััะตะฝัะธัะธะบะฐัะธั
- ะะทะผะตะฝะธัะต ััะฐะฝะดะฐััะฝัะน ะฟะฐัะพะปั ะฟะตัะตะด ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฒ ะฟัะพะดะฐะบัะตะฝะต
- ะะฐัััะพะนัะต AMI ั ะฑะตะทะพะฟะฐัะฝัะผะธ ะฟะฐัะพะปัะผะธ
- ะฃะฑะตะดะธัะตัั, ััะพ ะฟัะธะปะพะถะตะฝะธะต ะทะฐะฟััะตะฝะพ ะฒ ะฑะตะทะพะฟะฐัะฝะพะน ัะตัะธ
- ะะตะบะพะผะตะฝะดัะตััั ะธัะฟะพะปัะทะพะฒะฐัั HTTPS ะฒ ะฟัะพะดะฐะบัะตะฝะต

## ะขัะตะฑะพะฒะฐะฝะธั

- Node.js 14+
- Asterisk ั PJSIP
- ะะพัััะฟ ะฝะฐ ะทะฐะฟะธัั ะบ `/etc/asterisk/pjsip.conf`
- ะัะฐะฒะฐ sudo ะดะปั ะฟะตัะตะทะฐะณััะทะบะธ Asterisk
- **ะะปั ะผะพะฝะธัะพัะธะฝะณะฐ**: ะฝะฐัััะพะตะฝะฝัะน AMI ะฒ Asterisk
- **ะะปั ะปะพะณะพะฒ**: ะดะพัััะฟ ะบ ัะฐะนะปะฐะผ ะปะพะณะพะฒ Asterisk

## ะััะธัะตะบัััะฐ ะผะพะฝะธัะพัะธะฝะณะฐ

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   Browser   โโโโโบโ   Node.js    โโโโโบโ  Asterisk   โ
โ  (WebSocket)โ    โ (Socket.IO)  โ    โ    (AMI)    โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
                          โ
                          โผ
                   โโโโโโโโโโโโโโโโ
                   โ  Log Files   โ
                   โ  Monitoring  โ
                   โโโโโโโโโโโโโโโโ
```

## ะะธัะตะฝะทะธั

MIT 